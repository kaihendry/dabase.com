<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
<title>Web Forms 2.0 - Your daily Electricity cost</title>
</head>
<body>
<script type="text/javascript" src="wf2/webforms2.js"></script> 
<script type="text/javascript">
window.onload = init;

function init()
{
  var out = document.getElementById("out");
  out.value = total();
}

// invoked by onforminput on output element
// works around row dependent field names
function total()
{
  var rows = document.getElementById("items").rows;
	alert(rows.length);
  var price = document.form1.price.value;
  var result = 0;

  for (var i = 0; i < rows.length - 1; ++i)
  {
    var fields = rows[i].getElementsByTagName("INPUT");
    var wattage = fields[1].value;
    var time = fields[2].value;
    result += wattage * time * price;
  }

  return result;
}
</script>

<form name="form1" onsubmit="false">

<a href="http://www.flickr.com/photos/hendry/2508376346/in/set-72157605153273216/">Price per kiloWatt hour</a>:
<input name="price" type="number" title="Price per kiloWatt hour" value="12.2"/>

<fieldset>
<legend>List your appliances</legend>
<table>
<thead>
<tr>
<td>Quantity</td>
<td>Appliance</td>
<td>Wattage</td>
<td>Time (minutes)</td>
</tr>
</thead>

<tbody id="items">

<tr id="order" repeat="template">
      <td><input type="text" name="row[order].product" value=""></td>
      <td><input type="text" name="row[order].quantity" value="1"></td>
      <td><button type="remove">Remove This Row</button></td> 
</tr>


<tr repeat="1">
<td><input name="row1_quantity" type="number" value="1"/></td>
<td><input name="row1_item" type="text" value="Spot light"/></td>
<td><input name="row1_wattage" type="number" value="50"/></td>
<td><input name="row1_minutes" type="number" value="1440"/></td>
</tr>

<tr id="item" repeat="template" repeat-start="1">
<td><input name="row[line]_quantity" type="number" value="1"/></td>
<td><input name="row[line]_item" type="text" /></td>
<td><input name="row[line]_wattage" type="number" /></td>
<td><input name="row[line]_minutes" type="number"/></td>
</tr>

</tbody>
</table>
</fieldset>

<p>Total price: <output id="out" onforminput="value = total()">0</output> per day</p>

<button type="submit">Submit</button>
<button type="add" template="order">Add Row</button>
<button type="reset">Reset</button>
</form>

</body>
</html>
